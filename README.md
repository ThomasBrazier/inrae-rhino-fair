# FAIR code and data to reproduce the results of The geometry of gametic dispersal in a flying mammal



## Contact


Thomas Brazier
brazier.thomas@gmail.com
thomas.brazier@univ-rennes.fr



## Open and FAIR code and data policy

As of March 2025, PCI Ecology and PCI Evol Biol are implementing data and code curation for new submissions. Submissions are expected to fill all the criteria listed below to be recommended:

1. Is the data accessible, interoperable, and associated with appropriate metadata and licenses?

2. Is the data as described by the manuscript?

3. Is the code accessible, interoperable, and associated with appropriate metadata and licenses?

4. Does the code match the methods?

5. Does the code run without error?

6. Does running the code with the provided data produce the same results as written in the manuscript?


## Data and files

```
Data/Pic/coordPic.txt
Data/Pic/distancesDist.txt
Data/Pic/dyadsObs.txt
Data/Pic/dyadsObsSelect.txt
Data/Pic/resultsWithInfo.txt
Data/Pic/uniqueGenotypesWithInfo.txt
```

```
Data/Thu/coordThu.txt
Data/Thu/distancesDist.txt
Data/Thu/dyadsObsSelect.txt
Data/Thu/resultsWithInfo.txt
Data/Thu/uniqueGenotypesWithInfo.txt
```


`Analyses.zip`

`Data.zip`



## Reproduce analyses

I assume that you run these scripts on a Linux system. Before running each script, set your working directory to the script location.

The scripts to reproduce analyses must be run in this order:

(1) IBD

The script `IBD.R` analyses Isolation by Distance and produces `Fig. S2`. The intercept and slope of the IBD regression line are also calculated and a Mantel test is performed.


(2) COLONY

The COLONY analysis is performed in `AssignationPic` and `AssignationThu` for France and Germany, respectively.

The complete workflow is in these directories:

```
AssignationThu/01_prepadata # prepare the dataset
AssignationThu/01_prepadata/01a_ExtractData.R # Get the data and format the dataset

AssignationThu/02_colony # where to run COLONY
AssignationThu/02_colony/02_constructColony.R # Make the input files, config files and shell command files to launch COLONY

AssignationThu/03_simulations # Where to run COLONY on simulations
AssignationThu/03_simulations/03_simulations # Prepare input for COLONY simulation module

AssignationThu/04_data # The final data produced
```

For Thuringia (Thu) Outputs are stored in `AssignationThu/outputs` and the scripts to analyse and reformat the results are `AssignationThu/AnalyseColony.R` and `AssignationThu/AnalyseSimulations.R`, for the empirical data and the simulations, respectively. In addition,`AssignationThu/fonctionsColony.R` and `AssignationThu/fonctionsSim.R` are helper functions. The same organization applies to the Picardy (Pic) dataset.

The COLONY workflow is quite complex because it involved many manual steps and is also intensive in computation, hence I recommend not to run theses scripts unless you wish to perform a new complete analysis. All the outputs and results files are already stored in the appropriate directories to run downstream analyses.



(3) MasterBayes

`MasterBayes\MasterBayes.R` is a standalone script to run the MasterBayes analysis.
All input files are already in the directory.


NOTE that `MasterBayes` does not seem to be installable anymore (removed from CRAN).


(4) STRUCTURE

Everything needed to run the STRUCTURE analysis is in `STRUCTURE Dispersal.R`. Inputs. outputs and the STRUCTURE software and config files are stored in `./STRUCTURE`.


(5) FitDistR


```
fitDistR_model_comparison_Gametic reparameterized.R
fitDistR_model_comparison_Gametic.R
fitDistR_model_comparison.R
```

Outputs:

`fitDistR_model_comparison.R` output the estimated parameters of the mating dispersal kernel. The two following tables are necessary for `Fig. 2`.

```
Tables/ParamPic.txt # The best fit Kernel on the Mating Dispersal distances in Picardy
Tables/ParamThu.txt # The best fit Kernel on the Mating Dispersal distances in Thuringia
```

(6) Dispersal distances

```
Dispersal_Kernel_Gametic.R
Dispersal_Kernel.R
Gametic dispersal.R
Natal dispersal.R
```

(7) Figures and Tables

Run `Figures_preprint.R` to generate the figures presented in the paper.

```
Fig 1
Fig 2
Fig 3
Fig S1
```


The output generated by each analysis and presented in the manuscript are stored in `Tables\`.

```
Table 1
Table S1
```



## Reproduce Tables and Figures

Figures are stored in `Figures\` and tables in `Tables\`.

The script to reproduce all the figures in the main text is `Figures_preprint.R`.