inputcolony=rbind(inputcolony,data.frame(a="",b=""))
#   # Nombre de parents
inputcolony=rbind(inputcolony,
data.frame(a=paste(nrow(read.table(paste(wd,"Rhino_CMS.txt",sep=""))),"  ",
nrow(read.table(paste(wd,"Rhino_CFS.txt",sep=""))),sep=""),b="!Candidate ID and genotypes" )
)
#
#   # Parents
inputcolony=rbind(inputcolony,
data.frame(a=apply(read.table(paste(wd,"Rhino_CMS.txt",sep="")),1,function (x) paste(x,collapse=" ")),b="!Candidate ID and genotypes")
)
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
inputcolony=rbind(inputcolony,
data.frame(a=apply(read.table(paste(wd,"Rhino_CFS.txt",sep="")),1,function (x) paste(x,collapse=" ")),b="!Candidate ID and genotypes")
)
# #Zero
## maj de Colony
# Structure des donnees
# !Number of offspring with known paternity, exclusion threshold
# !IDs of known offspring-father dyad
inputcolony=rbind(inputcolony,
data.frame(a="!Number of offspring with known paternity, exclusion threshold",b=""))
inputcolony=rbind(inputcolony,
data.frame(a="0",b="0"))
# !Number of offspring with known maternity, exclusion threshold
#
inputcolony=rbind(inputcolony,
data.frame(a="!Number of offspring with known maternity, exclusion threshold",b=""))
inputcolony=rbind(inputcolony,
data.frame(a="0",b="0"))
# !Number of known paternal sibship
# !Size of known paternal sibship, and IDs of offspring in the sibship
inputcolony=rbind(inputcolony,
data.frame(a="!Number of known paternal sibship",b=""))
inputcolony=rbind(inputcolony,
data.frame(a="0",b=""))
# !Number of known maternal sibship
# !Size of known maternal sibship, and IDs of offspring in the sibship
inputcolony=rbind(inputcolony,
data.frame(a="!Number of known maternal sibship",b=""))
inputcolony=rbind(inputcolony,
data.frame(a="0",b=""))
# !Number of offspring with known excluded paternity
# !Offspring ID, number of excluded males, the IDs of excluded males
inputcolony=rbind(inputcolony,data.frame(a="!Number of offspring with known excluded paternity",b=""))
# Nombre d'excluded
inputcolony=rbind(inputcolony,
data.frame(a=as.character(nrow(read.table(paste(wd,"Rhino_ExcludedFathers.txt",sep=""),h=F,fill=TRUE))),b=""))
#Excludes
inputcolony=rbind(inputcolony,data.frame(a="! Excluded males",b=""))
Exclude=read.table(paste(wd,"Rhino_ExcludedFathers.txt",sep=""),h=F,fill=TRUE)
Exclude[,ncol(Exclude)+1]=nrow(Exclude)-1
Exclude=Exclude[,c(1,ncol(Exclude),2:(ncol(Exclude)-1))]
inputcolony=rbind(inputcolony,
data.frame(a=apply(Exclude,1,function (x) paste(x,collapse=" ")),b=""))
# !Number of offspring with known excluded maternity
# !Offspring ID, number of excluded females, the IDs of excluded females
inputcolony=rbind(inputcolony,data.frame(a="!Number of offspring with known excluded maternity",b=""))
# Nombre d'excluded
inputcolony=rbind(inputcolony,
data.frame(a=as.character(nrow(read.table(paste(wd,"Rhino_ExcludedMothers.txt",sep=""),h=F,fill=TRUE))),b=""))
#Excludes
inputcolony=rbind(inputcolony,data.frame(a="! Excluded females",b=""))
Exclude=read.table(paste(wd,"Rhino_ExcludedMothers.txt",sep=""),h=F,fill=TRUE)
Exclude[,ncol(Exclude)+1]=nrow(Exclude)-1
Exclude=Exclude[,c(1,ncol(Exclude),2:(ncol(Exclude)-1))]
inputcolony=rbind(inputcolony,
data.frame(a=apply(Exclude,1,function (x) paste(x,collapse=" ")),b=""))
# !Number of offspring with known excluded paternal sibships
inputcolony=rbind(inputcolony,data.frame(a="!Number of offspring with known excluded paternal sibships",b=""))
inputcolony=rbind(inputcolony,data.frame(a="0",b="0"))
# !Number of offspring with known excluded maternal sibships
inputcolony=rbind(inputcolony,data.frame(a="!Number of offspring with known excluded maternal sibships",b=""))
# Nombre d'excluded
inputcolony=rbind(inputcolony,
data.frame(a=as.character(nrow(read.table(paste(wd,"Rhino_ExcludedMaternalSibs.txt",sep=""),h=F,fill=TRUE))),b=""))
#Excludes
inputcolony=rbind(inputcolony,data.frame(a="! Excluded maternal Sibships",b=""))
Exclude=read.table(paste(wd,"Rhino_ExcludedMaternalSibs.txt",sep=""),h=F,fill=TRUE)
Exclude[,ncol(Exclude)+1]=nrow(Exclude)-1
Exclude=Exclude[,c(1,ncol(Exclude),2:(ncol(Exclude)-1))]
inputcolony=rbind(inputcolony,
data.frame(a=apply(Exclude,1,function (x) paste(x,collapse=" ")),b=""))
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
#Fin
inputcolony=rbind(inputcolony,
data.frame(a=c("!_________________NOTE_________________!",
"Input file generated by an R script",
"itself generated by Pierre-Loup JAN",
"and modified by Thomas BRAZIER"),b=""))
write.table(inputcolony,paste(wd,"Colony",r,".Dat",sep=""),quote=F,row.names = F,col.names = F)
}
timeOut=Sys.time()
cat("Construction des Colony.Dat en",difftime(timeOut,timeIn),"secondes.\n")
}
constructColony(1) # pour obtenir le fichier Colony.dat en n replicats (n graines aleatoires differentes)
View(effectifs)
1634+461+224+242
constructColony=function(n=1){
timeIn=Sys.time()
library(dplyr)
for (r in 1:n) {
inputcolony=data.frame()
# Parametres
inputcolony=rbind(inputcolony,
data.frame(a=c("RhinoThomas ! Project name",
"RhinoThomas ! Output file name",
paste(nrow(read.table(paste(wd,"Rhino_OFS.txt",sep=""))), "         ! Number of offspring in the sample",sep=""),
"8         ! Number of loci",
paste(round(runif(1,1000,9999),0),"      ! Seed for random number generator",sep=""),
"0         ! 0/1=Not updating/updating allele frequency",
"2         ! 2/1=Dioecious/Monoecious species",
"0         ! 0/1=Inbreeding absent/present",
"0         ! 0/1=Diploid species/HaploDiploid species",
"0  1      ! 0/1=Polygamy/Monogamy for males & females",
"0         ! 0/1 = Clone inference = No/Yes",
"1         ! 0/1=Scale full sibship=No/Yes",
"1 1 1     ! 0/1/2/3/4=No/Weak/Medium/Strong sibship prior; 4=Optimal sibship prior for Ne",
"0         ! 0/1=Unknown/Known population allele frequency",
"1         ! Number of runs",
"2         ! 1/2/3/4 = Short/Medium/Long/VeryLong run",
"0         ! 0/1=Monitor method by Iterate",
"10000     ! Monitor interval in Iterate",
"0         ! 0/1=DOS/Windows version",
"1         ! 0/1/2=Pair-Likelihood-Score(PLS)/Full-Likelihood(FL)/FL-PLS-combined(FPLS) method",
"1         ! 0/1/2/3=Low/Medium/High/VeryHigh precision",
"rha101 rha109  rha4  rha7  rhc108  rhc3  rhd102  rhd103",
"0  0 0 0 0 0 0 0",
"0.05 0.05  0.05  0.05  0.05  0.05  0.05  0.05",
"0.01 0.01  0.01  0.01  0.01  0.01  0.01  0.01",
""),b="")
)
# #Offsprings
inputcolony=rbind(inputcolony,
data.frame(a=apply(read.table(paste(wd,"Rhino_OFS.txt",sep="")),1,function (x) paste(x,collapse=" ")),b="!Offspring ID and genotypes")
)
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
# Proba de trouver des parents
inputcolony=rbind(inputcolony,
data.frame(a=c("0.5  1"),b="! Proba de trouver des parents"))
#   # Nombre de parents
inputcolony=rbind(inputcolony,
data.frame(a=paste(nrow(read.table(paste(wd,"Rhino_CMS.txt",sep=""))),"  ",
nrow(read.table(paste(wd,"Rhino_CFS.txt",sep=""))),sep=""),b="!Numbers of candidate males and females" )
)
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
#
#   # Parents
inputcolony=rbind(inputcolony,
data.frame(a=apply(read.table(paste(wd,"Rhino_CMS.txt",sep="")),1,function (x) paste(x,collapse=" ")),b="!Candidate ID and genotypes")
)
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
inputcolony=rbind(inputcolony,
data.frame(a=apply(read.table(paste(wd,"Rhino_CFS.txt",sep="")),1,function (x) paste(x,collapse=" ")),b="!Candidate ID and genotypes")
)
# #Zero
## maj de Colony
# Structure des donnees
# !Number of offspring with known paternity, exclusion threshold
# !IDs of known offspring-father dyad
inputcolony=rbind(inputcolony,
data.frame(a="!Number of offspring with known paternity, exclusion threshold",b=""))
inputcolony=rbind(inputcolony,
data.frame(a="0",b="0"))
# !Number of offspring with known maternity, exclusion threshold
#
inputcolony=rbind(inputcolony,
data.frame(a="!Number of offspring with known maternity, exclusion threshold",b=""))
inputcolony=rbind(inputcolony,
data.frame(a="0",b="0"))
# !Number of known paternal sibship
# !Size of known paternal sibship, and IDs of offspring in the sibship
inputcolony=rbind(inputcolony,
data.frame(a="!Number of known paternal sibship",b=""))
inputcolony=rbind(inputcolony,
data.frame(a="0",b=""))
# !Number of known maternal sibship
# !Size of known maternal sibship, and IDs of offspring in the sibship
inputcolony=rbind(inputcolony,
data.frame(a="!Number of known maternal sibship",b=""))
inputcolony=rbind(inputcolony,
data.frame(a="0",b=""))
# !Number of offspring with known excluded paternity
# !Offspring ID, number of excluded males, the IDs of excluded males
inputcolony=rbind(inputcolony,data.frame(a="!Number of offspring with known excluded paternity",b=""))
# Nombre d'excluded
inputcolony=rbind(inputcolony,
data.frame(a=as.character(nrow(read.table(paste(wd,"Rhino_ExcludedFathers.txt",sep=""),h=F,fill=TRUE))),b=""))
#Excludes
inputcolony=rbind(inputcolony,data.frame(a="! Excluded males",b=""))
Exclude=read.table(paste(wd,"Rhino_ExcludedFathers.txt",sep=""),h=F,fill=TRUE)
Exclude[,ncol(Exclude)+1]=nrow(Exclude)-1
Exclude=Exclude[,c(1,ncol(Exclude),2:(ncol(Exclude)-1))]
inputcolony=rbind(inputcolony,
data.frame(a=apply(Exclude,1,function (x) paste(x,collapse=" ")),b=""))
# !Number of offspring with known excluded maternity
# !Offspring ID, number of excluded females, the IDs of excluded females
inputcolony=rbind(inputcolony,data.frame(a="!Number of offspring with known excluded maternity",b=""))
# Nombre d'excluded
inputcolony=rbind(inputcolony,
data.frame(a=as.character(nrow(read.table(paste(wd,"Rhino_ExcludedMothers.txt",sep=""),h=F,fill=TRUE))),b=""))
#Excludes
inputcolony=rbind(inputcolony,data.frame(a="! Excluded females",b=""))
Exclude=read.table(paste(wd,"Rhino_ExcludedMothers.txt",sep=""),h=F,fill=TRUE)
Exclude[,ncol(Exclude)+1]=nrow(Exclude)-1
Exclude=Exclude[,c(1,ncol(Exclude),2:(ncol(Exclude)-1))]
inputcolony=rbind(inputcolony,
data.frame(a=apply(Exclude,1,function (x) paste(x,collapse=" ")),b=""))
# !Number of offspring with known excluded paternal sibships
inputcolony=rbind(inputcolony,data.frame(a="!Number of offspring with known excluded paternal sibships",b=""))
inputcolony=rbind(inputcolony,data.frame(a="0",b="0"))
# !Number of offspring with known excluded maternal sibships
inputcolony=rbind(inputcolony,data.frame(a="!Number of offspring with known excluded maternal sibships",b=""))
# Nombre d'excluded
inputcolony=rbind(inputcolony,
data.frame(a=as.character(nrow(read.table(paste(wd,"Rhino_ExcludedMaternalSibs.txt",sep=""),h=F,fill=TRUE))),b=""))
#Excludes
inputcolony=rbind(inputcolony,data.frame(a="! Excluded maternal Sibships",b=""))
Exclude=read.table(paste(wd,"Rhino_ExcludedMaternalSibs.txt",sep=""),h=F,fill=TRUE)
Exclude[,ncol(Exclude)+1]=nrow(Exclude)-1
Exclude=Exclude[,c(1,ncol(Exclude),2:(ncol(Exclude)-1))]
inputcolony=rbind(inputcolony,
data.frame(a=apply(Exclude,1,function (x) paste(x,collapse=" ")),b=""))
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
#Fin
inputcolony=rbind(inputcolony,
data.frame(a=c("!_________________NOTE_________________!",
"Input file generated by an R script",
"itself generated by Pierre-Loup JAN",
"and modified by Thomas BRAZIER"),b=""))
write.table(inputcolony,paste(wd,"Colony",r,".Dat",sep=""),quote=F,row.names = F,col.names = F)
}
timeOut=Sys.time()
cat("Construction des Colony.Dat en",difftime(timeOut,timeIn),"secondes.\n")
}
constructColony(1) # pour obtenir le fichier Colony.dat en n replicats (n graines aleatoires differentes)
constructColony=function(n=1){
timeIn=Sys.time()
library(dplyr)
for (r in 1:n) {
inputcolony=data.frame()
# Parametres
inputcolony=rbind(inputcolony,
data.frame(a=c("RhinoThomas ! Project name",
"RhinoThomas ! Output file name",
paste(nrow(read.table(paste(wd,"Rhino_OFS.txt",sep=""))), "         ! Number of offspring in the sample",sep=""),
"8         ! Number of loci",
paste(round(runif(1,1000,9999),0),"      ! Seed for random number generator",sep=""),
"0         ! 0/1=Not updating/updating allele frequency",
"2         ! 2/1=Dioecious/Monoecious species",
"0         ! 0/1=Inbreeding absent/present",
"0         ! 0/1=Diploid species/HaploDiploid species",
"0  1      ! 0/1=Polygamy/Monogamy for males & females",
"0         ! 0/1 = Clone inference = No/Yes",
"1         ! 0/1=Scale full sibship=No/Yes",
"1 1 1     ! 0/1/2/3/4=No/Weak/Medium/Strong sibship prior; 4=Optimal sibship prior for Ne",
"0         ! 0/1=Unknown/Known population allele frequency",
"1         ! Number of runs",
"2         ! 1/2/3/4 = Short/Medium/Long/VeryLong run",
"0         ! 0/1=Monitor method by Iterate",
"10000     ! Monitor interval in Iterate",
"0         ! 0/1=DOS/Windows version",
"1         ! 0/1/2=Pair-Likelihood-Score(PLS)/Full-Likelihood(FL)/FL-PLS-combined(FPLS) method",
"1         ! 0/1/2/3=Low/Medium/High/VeryHigh precision",
"rha101 rha109  rha4  rha7  rhc108  rhc3  rhd102  rhd103",
"0  0 0 0 0 0 0 0",
"0.05 0.05  0.05  0.05  0.05  0.05  0.05  0.05",
"0.01 0.01  0.01  0.01  0.01  0.01  0.01  0.01",
""),b="")
)
# #Offsprings
inputcolony=rbind(inputcolony,
data.frame(a=apply(read.table(paste(wd,"Rhino_OFS.txt",sep="")),1,function (x) paste(x,collapse=" ")),b="!Offspring ID and genotypes")
)
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
# Proba de trouver des parents
inputcolony=rbind(inputcolony,
data.frame(a=c("0.5  1"),b="! Proba de trouver des parents"))
#   # Nombre de parents
inputcolony=rbind(inputcolony,
data.frame(a=paste(nrow(read.table(paste(wd,"Rhino_CMS.txt",sep=""))),"  ",
nrow(read.table(paste(wd,"Rhino_CFS.txt",sep=""))),sep=""),b="!Numbers of candidate males and females" )
)
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
#
#   # Parents
inputcolony=rbind(inputcolony,
data.frame(a=apply(read.table(paste(wd,"Rhino_CMS.txt",sep="")),1,function (x) paste(x,collapse=" ")),b="!Candidate ID and genotypes")
)
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
inputcolony=rbind(inputcolony,
data.frame(a=apply(read.table(paste(wd,"Rhino_CFS.txt",sep="")),1,function (x) paste(x,collapse=" ")),b="!Candidate ID and genotypes")
)
# #Zero
## maj de Colony
# Structure des donnees
# !Number of offspring with known paternity, exclusion threshold
# !IDs of known offspring-father dyad
inputcolony=rbind(inputcolony,
data.frame(a="",b=""))
inputcolony=rbind(inputcolony,
data.frame(a="0  0",b="!Number of offspring with known paternity, exclusion threshold"))
# !Number of offspring with known maternity, exclusion threshold
#
inputcolony=rbind(inputcolony,
data.frame(a="",b=""))
inputcolony=rbind(inputcolony,
data.frame(a="0  0",b="!Number of offspring with known maternity, exclusion threshold"))
# !Number of known paternal sibship
# !Size of known paternal sibship, and IDs of offspring in the sibship
inputcolony=rbind(inputcolony,
data.frame(a="",b=""))
inputcolony=rbind(inputcolony,
data.frame(a="0   ",b="!Number of known paternal sibship"))
# !Number of known maternal sibship
# !Size of known maternal sibship, and IDs of offspring in the sibship
inputcolony=rbind(inputcolony,
data.frame(a="",b=""))
inputcolony=rbind(inputcolony,
data.frame(a="0   ",b="!Number of known maternal sibship"))
# !Number of offspring with known excluded paternity
# !Offspring ID, number of excluded males, the IDs of excluded males
inputcolony=rbind(inputcolony,data.frame(a="!Number of offspring with known excluded paternity",b=""))
# Nombre d'excluded
inputcolony=rbind(inputcolony,
data.frame(a=as.character(nrow(read.table(paste(wd,"Rhino_ExcludedFathers.txt",sep=""),h=F,fill=TRUE))),b=""))
#Excludes
inputcolony=rbind(inputcolony,data.frame(a="! Excluded males",b=""))
Exclude=read.table(paste(wd,"Rhino_ExcludedFathers.txt",sep=""),h=F,fill=TRUE)
Exclude[,ncol(Exclude)+1]=nrow(Exclude)-1
Exclude=Exclude[,c(1,ncol(Exclude),2:(ncol(Exclude)-1))]
inputcolony=rbind(inputcolony,
data.frame(a=apply(Exclude,1,function (x) paste(x,collapse=" ")),b=""))
# !Number of offspring with known excluded maternity
# !Offspring ID, number of excluded females, the IDs of excluded females
inputcolony=rbind(inputcolony,data.frame(a="!Number of offspring with known excluded maternity",b=""))
# Nombre d'excluded
inputcolony=rbind(inputcolony,
data.frame(a=as.character(nrow(read.table(paste(wd,"Rhino_ExcludedMothers.txt",sep=""),h=F,fill=TRUE))),b=""))
#Excludes
inputcolony=rbind(inputcolony,data.frame(a="! Excluded females",b=""))
Exclude=read.table(paste(wd,"Rhino_ExcludedMothers.txt",sep=""),h=F,fill=TRUE)
Exclude[,ncol(Exclude)+1]=nrow(Exclude)-1
Exclude=Exclude[,c(1,ncol(Exclude),2:(ncol(Exclude)-1))]
inputcolony=rbind(inputcolony,
data.frame(a=apply(Exclude,1,function (x) paste(x,collapse=" ")),b=""))
# !Number of offspring with known excluded paternal sibships
inputcolony=rbind(inputcolony,data.frame(a="!Number of offspring with known excluded paternal sibships",b=""))
inputcolony=rbind(inputcolony,data.frame(a="0",b="0"))
# !Number of offspring with known excluded maternal sibships
inputcolony=rbind(inputcolony,data.frame(a="!Number of offspring with known excluded maternal sibships",b=""))
# Nombre d'excluded
inputcolony=rbind(inputcolony,
data.frame(a=as.character(nrow(read.table(paste(wd,"Rhino_ExcludedMaternalSibs.txt",sep=""),h=F,fill=TRUE))),b=""))
#Excludes
inputcolony=rbind(inputcolony,data.frame(a="! Excluded maternal Sibships",b=""))
Exclude=read.table(paste(wd,"Rhino_ExcludedMaternalSibs.txt",sep=""),h=F,fill=TRUE)
Exclude[,ncol(Exclude)+1]=nrow(Exclude)-1
Exclude=Exclude[,c(1,ncol(Exclude),2:(ncol(Exclude)-1))]
inputcolony=rbind(inputcolony,
data.frame(a=apply(Exclude,1,function (x) paste(x,collapse=" ")),b=""))
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
#Fin
inputcolony=rbind(inputcolony,
data.frame(a=c("!_________________NOTE_________________!",
"Input file generated by an R script",
"itself generated by Pierre-Loup JAN",
"and modified by Thomas BRAZIER"),b=""))
write.table(inputcolony,paste(wd,"Colony",r,".Dat",sep=""),quote=F,row.names = F,col.names = F)
}
timeOut=Sys.time()
cat("Construction des Colony.Dat en",difftime(timeOut,timeIn),"secondes.\n")
}
constructColony(1) # pour obtenir le fichier Colony.dat en n replicats (n graines aleatoires differentes)
constructColony=function(n=1){
timeIn=Sys.time()
library(dplyr)
for (r in 1:n) {
inputcolony=data.frame()
# Parametres
inputcolony=rbind(inputcolony,
data.frame(a=c("RhinoThomas ! Project name",
"RhinoThomas ! Output file name",
paste(nrow(read.table(paste(wd,"Rhino_OFS.txt",sep=""))), "         ! Number of offspring in the sample",sep=""),
"8         ! Number of loci",
paste(round(runif(1,1000,9999),0),"      ! Seed for random number generator",sep=""),
"0         ! 0/1=Not updating/updating allele frequency",
"2         ! 2/1=Dioecious/Monoecious species",
"0         ! 0/1=Inbreeding absent/present",
"0         ! 0/1=Diploid species/HaploDiploid species",
"0  1      ! 0/1=Polygamy/Monogamy for males & females",
"0         ! 0/1 = Clone inference = No/Yes",
"1         ! 0/1=Scale full sibship=No/Yes",
"1 1 1     ! 0/1/2/3/4=No/Weak/Medium/Strong sibship prior; 4=Optimal sibship prior for Ne",
"0         ! 0/1=Unknown/Known population allele frequency",
"1         ! Number of runs",
"2         ! 1/2/3/4 = Short/Medium/Long/VeryLong run",
"0         ! 0/1=Monitor method by Iterate",
"10000     ! Monitor interval in Iterate",
"0         ! 0/1=DOS/Windows version",
"1         ! 0/1/2=Pair-Likelihood-Score(PLS)/Full-Likelihood(FL)/FL-PLS-combined(FPLS) method",
"1         ! 0/1/2/3=Low/Medium/High/VeryHigh precision",
"rha101 rha109  rha4  rha7  rhc108  rhc3  rhd102  rhd103",
"0  0 0 0 0 0 0 0",
"0.05 0.05  0.05  0.05  0.05  0.05  0.05  0.05",
"0.01 0.01  0.01  0.01  0.01  0.01  0.01  0.01",
""),b="")
)
# #Offsprings
inputcolony=rbind(inputcolony,
data.frame(a=apply(read.table(paste(wd,"Rhino_OFS.txt",sep="")),1,function (x) paste(x,collapse=" ")),b="!Offspring ID and genotypes")
)
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
# Proba de trouver des parents
inputcolony=rbind(inputcolony,
data.frame(a=c("0.5  1"),b="! Proba de trouver des parents"))
#   # Nombre de parents
inputcolony=rbind(inputcolony,
data.frame(a=paste(nrow(read.table(paste(wd,"Rhino_CMS.txt",sep=""))),"  ",
nrow(read.table(paste(wd,"Rhino_CFS.txt",sep=""))),sep=""),b="!Numbers of candidate males and females" )
)
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
#
#   # Parents
inputcolony=rbind(inputcolony,
data.frame(a=apply(read.table(paste(wd,"Rhino_CMS.txt",sep="")),1,function (x) paste(x,collapse=" ")),b="!Candidate ID and genotypes")
)
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
inputcolony=rbind(inputcolony,
data.frame(a=apply(read.table(paste(wd,"Rhino_CFS.txt",sep="")),1,function (x) paste(x,collapse=" ")),b="!Candidate ID and genotypes")
)
# #Zero
## maj de Colony
# Structure des donnees
# !Number of offspring with known paternity, exclusion threshold
# !IDs of known offspring-father dyad
inputcolony=rbind(inputcolony,
data.frame(a="",b=""))
inputcolony=rbind(inputcolony,
data.frame(a="0  0",b="!Number of offspring with known paternity, exclusion threshold"))
# !Number of offspring with known maternity, exclusion threshold
#
inputcolony=rbind(inputcolony,
data.frame(a="",b=""))
inputcolony=rbind(inputcolony,
data.frame(a="0  0",b="!Number of offspring with known maternity, exclusion threshold"))
# !Number of known paternal sibship
# !Size of known paternal sibship, and IDs of offspring in the sibship
inputcolony=rbind(inputcolony,
data.frame(a="",b=""))
inputcolony=rbind(inputcolony,
data.frame(a="0   ",b="!Number of known paternal sibship"))
# !Number of known maternal sibship
# !Size of known maternal sibship, and IDs of offspring in the sibship
inputcolony=rbind(inputcolony,
data.frame(a="",b=""))
inputcolony=rbind(inputcolony,
data.frame(a="0   ",b="!Number of known maternal sibship"))
# !Number of offspring with known excluded paternity
# !Offspring ID, number of excluded males, the IDs of excluded males
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
# Nombre d'excluded
inputcolony=rbind(inputcolony,
data.frame(a=as.character(nrow(read.table(paste(wd,"Rhino_ExcludedFathers.txt",sep=""),h=F,fill=TRUE))),b="!Number of offspring with known excluded paternity"))
#Excludes
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
Exclude=read.table(paste(wd,"Rhino_ExcludedFathers.txt",sep=""),h=F,fill=TRUE)
Exclude[,ncol(Exclude)+1]=nrow(Exclude)-1
Exclude=Exclude[,c(1,ncol(Exclude),2:(ncol(Exclude)-1))]
inputcolony=rbind(inputcolony,
data.frame(a=apply(Exclude,1,function (x) paste(x,collapse=" ")),b="! Excluded males"))
# !Number of offspring with known excluded maternity
# !Offspring ID, number of excluded females, the IDs of excluded females
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
# Nombre d'excluded
inputcolony=rbind(inputcolony,
data.frame(a=as.character(nrow(read.table(paste(wd,"Rhino_ExcludedMothers.txt",sep=""),h=F,fill=TRUE))),b="!Number of offspring with known excluded maternity"))
#Excludes
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
Exclude=read.table(paste(wd,"Rhino_ExcludedMothers.txt",sep=""),h=F,fill=TRUE)
Exclude[,ncol(Exclude)+1]=nrow(Exclude)-1
Exclude=Exclude[,c(1,ncol(Exclude),2:(ncol(Exclude)-1))]
inputcolony=rbind(inputcolony,
data.frame(a=apply(Exclude,1,function (x) paste(x,collapse=" ")),b="! Excluded females"))
# !Number of offspring with known excluded paternal sibships
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
inputcolony=rbind(inputcolony,data.frame(a="0  0",b="!Number of offspring with known excluded paternal sibships"))
# !Number of offspring with known excluded maternal sibships
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
# Nombre d'excluded
inputcolony=rbind(inputcolony,
data.frame(a=as.character(nrow(read.table(paste(wd,"Rhino_ExcludedMaternalSibs.txt",sep=""),h=F,fill=TRUE))),b="!Number of offspring with known excluded maternal sibships"))
#Excludes
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
Exclude=read.table(paste(wd,"Rhino_ExcludedMaternalSibs.txt",sep=""),h=F,fill=TRUE)
Exclude[,ncol(Exclude)+1]=nrow(Exclude)-1
Exclude=Exclude[,c(1,ncol(Exclude),2:(ncol(Exclude)-1))]
inputcolony=rbind(inputcolony,
data.frame(a=apply(Exclude,1,function (x) paste(x,collapse=" ")),b="! Excluded maternal Sibships"))
inputcolony=rbind(inputcolony,data.frame(a="",b=""))
#Fin
inputcolony=rbind(inputcolony,
data.frame(a=c("!_________________NOTE_________________!",
"Input file generated by an R script",
"itself generated by Pierre-Loup JAN",
"and modified by Thomas BRAZIER"),b=""))
write.table(inputcolony,paste(wd,"Colony",r,".Dat",sep=""),quote=F,row.names = F,col.names = F)
}
timeOut=Sys.time()
cat("Construction des Colony.Dat en",difftime(timeOut,timeIn),"secondes.\n")
}
constructColony(1) # pour obtenir le fichier Colony.dat en n replicats (n graines aleatoires differentes)
